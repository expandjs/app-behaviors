<!--
@license
Copyright (c) 2017 The expand.js authors. All rights reserved.
This code may only be used under the BSD style license found at https://expandjs.github.io/LICENSE.txt
The complete set of authors may be found at https://expandjs.github.io/AUTHORS.txt
The complete set of contributors may be found at https://expandjs.github.io/CONTRIBUTORS.txt
-->

<!--
A web component used to add the `authorize` command on the parent store.

@element cmd-authorize
@since 1.0.0
@category functionality
@description A web component used to add the `authorize` command on the parent store
@keywords expandjs, web app, web components

@homepage https://expandjs.com/components/cmd-authorize
@repository https://github.com/expandjs/app-behaviors
@source https://github.com/expandjs/app-behaviors/blob/master/cmd-authorize.html

@behavior app-command-behavior /bower_components/app-behaviors/app-command-behavior.html
-->

<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../../expandjs/expandjs.html">
<link rel="import" href="../app-command-behavior.html">

<dom-module id="cmd-authorize">

    <template strip-whitespace>

        <style>
            :host {
                display: none !important;
            }
        </style>

    </template>

    <script>
        Polymer({

            // ELEMENT
            is: 'cmd-authorize',

            // BEHAVIORS
            behaviors: [
                Polymer.APPCommandBehavior
            ],

            /*********************************************************************/

            /**
             * Fired on execute.
             *
             * @event app-authorize
             * @param {Object} data
             * @param {string} source
             * @param {boolean} remember
             * @param {Function} callback
             * @bubbles
             */

            /*********************************************************************/

            /**
             * Implements the `execute` strategy.
             *
             * @method _execute
             * @param {Object} options
             *   @param {Object} options.data
             *   @param {string} options.source
             *   @param {boolean} [options.remember = false]
             * @param {Function} [callback]
             * @private
             */
            _execute(options, callback) {

                // Asserting
                if (!XP.isObject(options.data)) { callback(new XP.ValidationError('options.data', 'Object')); return; }
                if (!XP.isString(options.source, true)) { callback(new XP.ValidationError('options.source', 'string')); return; }

                // Preparing options
                let opts = {
                    data: options.data,
                    source: options.source,
                    remember: options.remember,
                    callback: callback
                };

                // Firing
                this.fire('app-authorize', opts);
            }
        });
    </script>

</dom-module>
